import React from 'react';
import classNames from 'classnames';

import useFetch from 'hooks/useFetch';

const AddToFavorites = ({ isFavorite, favoritesCount, articleSlug}) => {
    const apiUrl = `/articles/${articleSlug}/favorite`;
    const [{response}, doFetch] = useFetch(apiUrl);
    const favoritesCountWithRes = response ? response.article.favoritesCount : favoritesCount;
    const isFavoriteCountWithRes = response ? response.article.favorited : isFavorite;

    const buttonClasses = classNames({
        'btn': true,
        'btn-sm': true,
        'btn-primary': isFavoriteCountWithRes,
        'btn-outline-primary': !isFavoriteCountWithRes

    });

    const handleLike = e => {
        e.preventDefault();

        doFetch({
            method: isFavoriteCountWithRes ? 'delete' : 'post'
        })
    };

    return (
        <button className={buttonClasses} onClick={handleLike}>
            <i className="ion-heart" />
            <span>{' '} {favoritesCountWithRes}</span>
        </button>
    );
};

export default AddToFavorites;